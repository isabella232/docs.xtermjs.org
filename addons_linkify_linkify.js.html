<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>addons/linkify/linkify.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-xterm_src_xterm.html">xterm/src/xterm</a><ul class='methods'><li data-type='method'><a href="module-xterm_src_xterm.html#.bindBlur">bindBlur</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.bindCopy">bindCopy</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.bindCut">bindCut</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.bindDrop">bindDrop</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.bindFocus">bindFocus</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.bindKeys">bindKeys</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.bindPaste">bindPaste</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.click">click</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.loadAddon">loadAddon</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#.prepareCopiedTextForClipboard">prepareCopiedTextForClipboard</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#bell">bell</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#bindMouse">bindMouse</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#blur">blur</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#clearSelection">clearSelection</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#cursorForwardTab">cursorForwardTab</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#cursorUp">cursorUp</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#destroy">destroy</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#eraseAttr">eraseAttr</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#error">error</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#evaluateKeyEscapeSequence">evaluateKeyEscapeSequence</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#focus">focus</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#index">index</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#initGlobal">initGlobal</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#insertChars">insertChars</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#insertRow">insertRow</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#keyDown">keyDown</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#keyPress">keyPress</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#leaseContentEditable">leaseContentEditable</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#log">log</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#maxRange">maxRange</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#open">open</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#refresh">refresh</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#resize">resize</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#scroll">scroll</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#scrollDisp">scrollDisp</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#send">send</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#setgCharset">setgCharset</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#setgLevel">setgLevel</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#showCursor">showCursor</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#updateRange">updateRange</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#write">write</a></li><li data-type='method'><a href="module-xterm_src_xterm.html#writeln">writeln</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-xterm_addons_attach_attach.html">xterm/addons/attach/attach</a><ul class='methods'><li data-type='method'><a href="module-xterm_addons_attach_attach.html#.attach">attach</a></li><li data-type='method'><a href="module-xterm_addons_attach_attach.html#.detach">detach</a></li></ul></li><li><a href="module-xterm_addons_fit_fit.html">xterm/addons/fit/fit</a></li><li><a href="module-xterm_addons_linkify_linkify.html">xterm/addons/linkify/linkify</a><ul class='methods'><li data-type='method'><a href="module-xterm_addons_linkify_linkify.html#.findLinkMatch">findLinkMatch</a></li><li data-type='method'><a href="module-xterm_addons_linkify_linkify.html#.linkify">linkify</a></li><li data-type='method'><a href="module-xterm_addons_linkify_linkify.html#.linkifyTerminalLine">linkifyTerminalLine</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="module-xterm_addons_linkify_linkify.html#~event:linkify">linkify</a></li><li><a href="module-xterm_addons_linkify_linkify.html#~event:linkify:line">linkify:line</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">addons/linkify/linkify.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>(function (linkify) {
  if (typeof exports === 'object' &amp;&amp; typeof module === 'object') {
    /*
     * CommonJS environment
     */
    module.exports = linkify(require('../../src/xterm'));
  } else if (typeof define == 'function') {
    /*
     * Require.js is available
     */
    define(['../../src/xterm'], linkify);
  } else {
    /*
     * Plain browser environment
     */
    linkify(this.Xterm);
  }
})(function (Xterm) {
  'use strict';

  /**
   * This module provides methods for convertings valid URL substrings
   * into HTML anchor elements (links), inside a terminal view.
   *
   * @module xterm/addons/linkify/linkify
   */
  var exports = {},
      protocolClause = '(https?:\\/\\/)',
      domainCharacterSet = '[\\da-z\\.-]+',
      negatedDomainCharacterSet = '[^\\da-z\\.-]+',
      domainBodyClause = '(' + domainCharacterSet + ')',
      tldClause = '([a-z\\.]{2,6})',
      ipClause = '((\\d{1,3}\\.){3}\\d{1,3})',
      portClause = '(:\\d{1,5})',
      hostClause = '((' + domainBodyClause + '\\.' + tldClause + ')|' + ipClause + ')' + portClause + '?',
      pathClause = '(\\/[\\/\\w\\.-]*)*',
      negatedPathCharacterSet = '[^\\/\\w\\.-]+',
      bodyClause = hostClause + pathClause,
      start = '(?:^|' + negatedDomainCharacterSet + ')(',
      end = ')($|' + negatedPathCharacterSet + ')',
      lenientUrlClause = start + protocolClause + '?' + bodyClause + end,
      strictUrlClause = start + protocolClause + bodyClause + end,
      lenientUrlRegex = new RegExp(lenientUrlClause),
      strictUrlRegex = new RegExp(strictUrlClause);

  /**
   * Converts all valid URLs found in the given terminal line into
   * hyperlinks. The terminal line can be either the HTML element itself
   * or the index of the termina line in the children of the terminal
   * rows container.
   *
   * @param {Xterm} terminal - The terminal that owns the given line.
   * @param {number|HTMLDivElement} line - The terminal line that should get
   *								  		 "linkified".
   * @param {boolean} lenient - The regex type that will be used to identify links. If lenient is
   *                            false, the regex requires a protocol clause. Defaults to true.
   * @emits linkify
   * @emits linkify:line
   */
  exports.linkifyTerminalLine = function (terminal, line, lenient) {
    if (typeof line == 'number') {
      line = terminal.rowContainer.children[line];
    } else if (! (line instanceof HTMLDivElement)) {
      var message = 'The "line" argument should be either a number';
      message += ' or an HTMLDivElement';

      throw new TypeError(message);
    }

    var buffer = document.createElement('span'),
        nodes = line.childNodes;

    for (var j=0; j&lt;nodes.length; j++) {
      var node = nodes[j],
          match;

      /**
       * Since we cannot access the TextNode's HTML representation
       * from the instance itself, we assign its data as textContent
       * to a dummy buffer span, in order to retrieve the TextNode's
       * HTML representation from the buffer's innerHTML.
       */
      buffer.textContent = node.data;

      var nodeHTML = buffer.innerHTML;

      /**
       * Apply function only on TextNodes
       */
      if (node.nodeType != node.TEXT_NODE) {
        continue;
      }

      var url = exports.findLinkMatch(node.data, lenient);

      if (!url) {
        continue;
      }

      var startsWithProtocol = new RegExp('^' + protocolClause),
          urlHasProtocol = url.match(startsWithProtocol),
          href = (urlHasProtocol) ? url : 'http://' + url,
          link = '&lt;a href="' +  href + '" >' + url + '&lt;/a>',
          newHTML = nodeHTML.replace(url, link);

      line.innerHTML = line.innerHTML.replace(nodeHTML, newHTML);
    }

    /**
     * This event gets emitted when conversion of all URL susbtrings
     * to HTML anchor elements (links) has finished, for a specific
     * line of the current Xterm instance.
     *
     * @event linkify:line
     */
    terminal.emit('linkify:line', line);
  };

  /**
   * Finds a link within a block of text.
   *
   * @param {string} text - The text to search .
   * @param {boolean} lenient - Whether to use the lenient search.
   * @return {string} A URL.
   */
  exports.findLinkMatch = function (text, lenient) {
    var match = text.match(lenient ? lenientUrlRegex : strictUrlRegex);
    if (!match || match.length === 0) {
      return null;
    }
    return match[1];
  }

  /**
   * Converts all valid URLs found in the terminal view into hyperlinks.
   *
   * @param {Xterm} terminal - The terminal that should get "linkified".
   * @param {boolean} lenient - The regex type that will be used to identify links. If lenient is
   *                            false, the regex requires a protocol clause. Defaults to true.
   * @emits linkify
   * @emits linkify:line
   */
  exports.linkify = function (terminal, lenient) {
    var rows = terminal.rowContainer.children;

    lenient = (typeof lenient == "boolean") ? lenient : true;
    for (var i=0; i&lt;rows.length; i++) {
      var line = rows[i];

      exports.linkifyTerminalLine(terminal, line, lenient);
    }

    /**
     * This event gets emitted when conversion of  all URL substrings to
     * HTML anchor elements (links) has finished for the current Xterm
     * instance's view.
     *
     * @event linkify
     */
    terminal.emit('linkify');
  };

  /**
   * Extend Xterm prototype.
   */

  /**
   * Converts all valid URLs found in the current terminal linte into
   * hyperlinks.
   *
   * @memberof Xterm
   * @param {number|HTMLDivElement} line - The terminal line that should get
   *								  		 "linkified".
   * @param {boolean} lenient - The regex type that will be used to identify links. If lenient is
   *                            false, the regex requires a protocol clause. Defaults to true.
   */
  Xterm.prototype.linkifyTerminalLine = function (line, lenient) {
    return exports.linkifyTerminalLine(this, line, lenient);
  };

  /**
   * Converts all valid URLs found in the current terminal into hyperlinks.
   *
   * @memberof Xterm
   * @param {boolean} lenient - The regex type that will be used to identify links. If lenient is
   *                            false, the regex requires a protocol clause. Defaults to true.
   */
  Xterm.prototype.linkify = function (lenient) {
    return exports.linkify(this, lenient);
  };

  return exports;
});
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Jul 11 2016 22:33:45 GMT+0000 (UTC) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
